## **Assignment 2 - ECG Filtering to Remove Noise**
#### **Assignment Description**
After this assignment student can * remove high-frequency noise from signal * remove low-frequency noise from signal * remove power-line interference from signal * describe how each filter affects in time and frequency domain

Background Read chapter 3 from the course book.

ECG signals are often contaminated with a combination of high-frequency noise, low-frequency noise (baseline wandering), and power-line interference. High-frequency noise may be removed by applying a lowpass filter and low-frequency noise may be removed by applying a highpass filter. However, improper selection of the cutoff frequencies of the filters could lead to distortions in ECG signal, such as excessive smoothing or widening of the QRS complex, and distortion of PQ and ST segments.

Useful MATLAB commands fft, filter, freqz, nextpow2, conj, ones, conv, semilogy, sgolayfilt

## [Load and select data](https://grader.mathworks.com/courses/91023-521273s-biosignal-processing-i-online-labs-autumn-2022/assignments/244168-assignment-2-ecg-filtering-to-remove-noise/problems/869053-load-and-select-data)
Load ECG data into MATLAB.

The data is stored in files named 'ecg_signal_1.dat', and 'ecg_signal_2.dat'.

Select the part from 2 s to 3 s from the first signal, and create sample time vector in seconds for that interval. Similarly, the interval from 1 s to 2 s from the second signal creating the sample time vector in seconds.

## [Compute power spectrum](https://grader.mathworks.com/courses/91023-521273s-biosignal-processing-i-online-labs-autumn-2022/assignments/244168-assignment-2-ecg-filtering-to-remove-noise/problems/869058-compute-power-spectrum)
Background

The power spectrum of x is

![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU4AAABGCAYAAACjd32wAAAQvUlEQVR4Xu2d1+s+RxXGkz9AY73QeBEsoBeiGE1AVFCwi0RUbKABRWNBsLeIiCgWRBA7BoIkFhT0xg4KNjAaMaAoqEFsV7Gg3uv5/PI+eDJO3Xff99139ywcvmVmZ2eeOfPsmTlnZi++KK5AIBAIBAKBIQQuHsodmQOBQCAQCAQuCuIMJQgEAoFAYBCBIM5BwCJ7IBAIBAJBnKEDgUAgEAgMIhDEOQhYZA8EAoFAIIgzdCCHwEPsn7cENIFAIJBHIIgzNMMj8Cj741qTK0zuFtAEAoFAEGfoQBkBLMz3mTxxl+XvQZyhLoFAGYGwOEM7XmYQXGLyC5MbTO5qEsQZehEIVBAI4gz18Ah8Y2d1BnGGXgQCQZyhA50IBHF2AhXZto1AWJzb7v+09UGcoQ+BQAcCQZwdIG0oSxDnhjo7mjodgSDO6dit8c4gzjX2arRpdgSCOGeH9KwLDOI86+6Lyh8LgSUS592t8c8y+eSBQSAM59DPOHATZi9+S8QZeja7+sxeIPHFl5p8bfaS/1fgfe3XB44+Y2nEiTLfaPImk0Nv+XuKPePVJi8w+esBO+acit4KcYaeLV8rtSnjGOPzjQbHZSav6IVllDjZkqfrV45waOS/TG7tfXAmH8rMwH3JEUhTj3+u/fI6kycFeV6AZAnEiQVw74Ye/WCXjs48qJD3LwV9DD3LA1bDMjfmPRf4EuGBfY0e+OTTRx6XH9s1oos8e4gTRX69yct3BX9z9/P+9vNbu99Je7SJFLqh99lkBu13TN4/5eY97hl+2+zxrKXfuhTiZOr0TpOHJ4A9z/7mha2ByWC/MpOXGct1JrmZROhZnThfZcnPSbK8x/7+ejK+Ic407xfsf281SQ0olsW+VOiPtDb06W9Mnr4nn0wZa+jG9Safb93cIk6Y/7smbMMDFCw0XXpzS7lbZdXqAnm91AQyPvZFO35swrT9kGspx27XlOctgTi9fjGA0D0uBu/bCo16t/2fAfs7E4i0tPQSetanFdIDcv/U5BGF21ju+uou7aH2M2dpQrDfb/SfL55nQ7xdll9fc7pzie/gtOrsuUV2rYGENYqy1sBt1VpvGIBqMn2rsInpvBAw1R9QGXQTiz6r21r9fezGiBA1gHNLKlL2vzVIM/Ssv/c8IXLX/TJE4g2nlDThBRy8zE4h0/+YMFv4tsmLTX5kkpudimRzz+uv/X454QHqj64VrxpxAsxtuztrxPgTy8OUvWQNtJpxSitAddOgeov9Y8ue9qURp17M6qd0gPrB2xpsoWetkXjH9N/uCJP/XpMZFxAMS3QQYmrwiAC5lz7j5C2WT1i3xJorzR5OaW2q9ap7yYK+kK9GnL7xEGfJgdK9LlDoNyyFj+9BvGPqUM6NIjzB5BTLBXO1Yd9ylkactMdPG9ETP4VTWs/6eujZmHbwooHwuNLxrzTIsOST4KX2eJOrduMKcv2eiV+j9jVi5vBzk6eanHrJjJcGxmBxuaBGnOnbvtQgprk3mUzxqGtKsASwaMfnTKpvmjHdO7vcSyRO9QtgcmqTllNk8eSsoRT4NesZBs4+TtmSkqbjXy8n9Ufq80jL4X4OxIY4sTIhoy+bMF3PcYWWZe5h6acOD0S3aGfxMO/eNU4p7WPtl31DDTzA+4DFYHjarnFfsZ9+uqA1lofZ/1mDTT2COWXRG69nIJ4dI3ZU2M8wyN5jxXUUO0sWrEU5iZgacn7oJ0xqDqMt6JnGT83y26cDGFPysGPts4yFVdjyaWgs8aLDO/4hk9fsfkKiufqy5MdVckSV2sFYx7J9hsnNJkRTeGKGAB9swlIOPNFj5BEFgH4VjagWcQoAVRrAAHKKdZlruCycVj38vRDmh014G7RCFvwaWA8hsoidTgdLHeb/3xMD11NOKfaw596peSDM55uggOmFIv7Q5NRTJ1mX1I8XIYOgZfH4tqxFz9L+EbGNYDGiJ6m1z70tJxx5GA84gXAO/ckEX4mcQziNfmmSWsmMPfJXnTKu8jzjXSasszJm325Ss1TVlh4OkxGRW7+9UIUewvLgSXFZC5yDPOkE3gC9YPm6pCY9JH8nEx+YT311D2+/VpjBaOepH1NrzfXv0K895D5U4Eoypy/wVthR2uy16BlGw6/d2JNl5PVm7m2K3toH19GlLPVdbXagPL2WszeI0nJlxOQC8eXwas1UNJ6L9ekhTk8+Usge1u4ZsyNE5UkzXRP14RNpmie14htkV1ksE5xDow4ibQ/raXMtD5b0qa27fdtwqPuZyilmuKX4aR3WoGciSdomHU89wLUxMrVffEgYFuGULZDUszabahKVq7wnzdySgfQkl6aZR83ZrUdVZ5+9xJkjT6YHrzTZZyG3V6GZRtJY1rlygPi3Yo04WwNuypRuqkLGfWMIeOIctTjXoGd+M4onT3QfhxnrfDg3ucDnmSZz+CM8cVL2qMXZ08sjxOnrk451/3KpESd1ajmhqjozQpw8zIco8Pe+U8tehfZrXKnVmAbrpk4Nb3EGcfao8fLy+P5X7UYiMdakZ3KKslz2KZM3m7zXhJ13/F0KLp/Sq+kyHWW0xtCU5/QSp/f083JIZ4b+5ZpbL/WhbUclTkDxnrYcq+vUIX1qlgaUTjvqVWhZlLmPiHkyb6W3pupTPXtTlCXu6UPAr+NhdenMhBGHyFr1TERwCDLTuiM444321mxtW2tfr94xVy9xeosyZ7TRz7pq6TnS9TXS5p8irjmLE1O4Fr7jdxTxMM/cvKE4beiDJv80eaGJwhly4S0s1iI155C3GHODxb9Fcg311kprd0nvAEuV45y96lMU/Vj3aDahfk+dRK3+VD3Xome0RxYnY42dbm8w+cDu51wWp5bGvAc9DQmbc3u0LMmWc8iP9XTJIHXQphalt1ZbkTNNIs8RJ1bXO0xqToqSyYuCph73WshEz5qityhzwLbMb3V4j4UCcU55e4dXfX4q1ZpeGnXhp2O9S0Vr0DO/zg/aWqpAZyEJv8bpNwqM9oycL7yU/NkNfm2xZyyNPrfHaPEWZcpdrSU5b6221mlVVnE5KEecVK6lkFJEb/LysCebpHvWZTXkpvUixZrl4Ikz1xDVJUeqHszWmlgzdquiCcf2qv/Z6tI6s3JUcY+R/zP2kBd1PEgnVpE1nRb6dbce7yhlrEHPch5z6Wy6q4c2T93AIEMnd3AH411Xr7Xf0d0XsvREtIg4c1wiLEovDe9RbwXZN/UlJU6Zs7WwAz9V77HO1KDcW6pnf2ouDEOdocM58LbnFEVgtUxzytNz5laIXsUZybdm4vThJrkF/HSpqIcg1qJnaVhPbs84Y5h45ikedS1rlYwMb+23ptUj+uzHX81po9ljzQjLOYW8AdUzvnl5EPpWDEusmbslYARub0iI3pQlK5bpfW1DvV+bSMvwjqrU8aPn9tYTkuXqDcYfVYzI34eABmdt1uP7vXfauEY9k2HQi0GtBzQVr5XljZjecdXX67fvXKPMmgO3xD1+7TudhYzuHqS+WLbVF0NKnHqDaVsb7E1QNo6e+5hcbYK3fAQ0GotpXDpdiWcSUlE7C1P1oj46sQRrF8eTjq2iwaSxo0kd3Buw29NpvQoQ+aYhQB8waBXkXrMM0vCk1jIMNVqjnsk4aEWL1HrEb10kX62sNDwJcimdtD9FC1rGi59hqp7UCX3A+PqICYcmK83rVI+OUGe1sWqZpsQJ4WgfqU43eYz9T/uY2bvcc2CGQBMh1aZTvQfMYm5zVP9ddoVz0oqO46cM9sCy0Z8L8vysSe+pMQyqZ5u01j6mKEPc00aAvr02yfYP+/tnJv7YMpSaAxsuzxTZ0s3Qs/8HjfGJAaIxpRx8woaxpW3V9M8jTR6XwZ08HBc3h5ddU+oaaWkfvOqSjnXK8GcveJ5oa+Lta63oUvV84dEA+J4H+zxUgoq3DgfGgXSDySlOYJe3snVgyGjbI//yEAg9W16fpDViyYAX4ymWzLr145DECQBcvSfDY25zHftbI5D7KT4SN7cK86ZNr/TAE5+uQ1HSe3KHI5BHGxt443N90cRP01rpc7d3anmhZ1ORO859WpMkFnwOK7a31pqRdBlQhyJOplRM8VtHPaWNgsSuPyJgTNEvOwFZ93bmSD5Np3RqN/fWHCwQJ5/WhUj8B9HS8wwpR2vMKg9HC9Mp/d1KH2nHMfKGnh0D5enPUDjaXPvte2oypBOHIE5I82qT9BQVLUK3LEoG8lxrJjXARO6t+vSAvqQ83nHS4xyTN7UUWpbu3qGtCguBOP9owpcOvTfWp7eWaU6FXejZqZDvey58caNJabt2Xyl9uYZ1YW7i1CAjbvL3SZ05hKD3E7yUU9u51AdHPdcxnjFHPUfLSD3OrV0SpYBnPVfWpXfw+VjBVvpo/Y+Z/xg6cIxnHBOzYz5LW5l7nbxT6jYp7nVO4kyPvUobMRLCNAWAuOd2BERkwqMV/I91iOSCfRWakTs8hfJb6eRB+T9qsu8RhNG/gcBiEJiTOBfTqA1XxB+WoLXO2r7l1uncrQDrVjpdgQUMwRY/fLXh/oqmnykCQZxn2nGFavuPTPG7jmArOYmUPxdnW9uxxeNb6T6wumX1rqsXojWrRyCIc11dzHolp1Nh3fn9uaXDMLS+KT3wx+MR8CyrFeJlY8QlJvc0YTkglw6ahDNdasKOMzzvXCzwc8Au1yHXq9bVm9GaxSIQxLnYrplUMdYqIUNFCvhDGXJWJfnZqsZUmksREfx+hYnClPDOc93L5N8mkGMunTzEjhLmxJqpiBPi5hMr1+/qN6lxcVMgsBQEgjiX0hP71yN3LJ7fW5we3qD8pWl87SQaattKHznGa//WRwmBwBERCOI8ItgHflTpDEH/2RH/eeTamYN+/TIX39lKp6k6O7Hn6MEDQxPFBwLzIhDEOS+epyyNaTlT6zSsyJ/c7a3L2sGx3lLNnSrTSvcf0Os5L/OUuMWzA4FhBII4hyFb5A063DfnvfbWoZxENOI2k5I16Mk2d7DsSHro2CJVJiq1DwKh1Pugt5x7ZeGVzhz0B/9iAd7ZhG2SJWtQ65OlrwG20uWUyp3GvRzUoiaBwEQEgjgnArew27TNsvTZAR+ahJMIQiTGsxSUrvXJUvxlLd1/2qL17aqFwRjVCQT6EAji7MNp6bmIq2SHUO0gZr8Vkyk75KkwJN8+T7K508Bb6X79s7VPfum4Rv0CgSwCQZznrxitbZNqof9eDP8rfSKh9RnVVrqs39L+9vNHPFqweQSCOM9fBURkrW+q+O+10OrS5wlaxNdKl2WruFHCnv5gcsxDac+/V6MFi0YgiHPR3dNVORFV7bOqKkikl/u8qvKkxJdWopbuPfhYtFxXFZYEuhoXmQKBJSIQxLnEXumvk58298RL+tOT/EfQ9MSWY6eVnu6PJ670ShO2W8YVCKwGgSDO8+1KfdRKLch9FTLXOqxOTmW/JZPoiS/n2Gml6+xNvpq4hu84na92RM0PikAQ50HhPbvC/ffrc18ZbKWfXYOjwoHAFASCOKegtt57FLheir9spa8XmWhZIOAQCOLcrjqw3snRcDeZ3Gqi9U/tFmqlbxe5aPnmEQji3K4K6NQkDhnGUaRpuMKaWunbRS5avnkEgji3qwJ+2q1P/Popeit9u8hFyzePQBDndlUAD/hrTS43udnkut2UXYi00reLXLR88wgEcW5eBQKAQCAQGEUgiHMUscgfCAQCm0cgiHPzKhAABAKBwCgC/wUm7OuDVnZYtgAAAABJRU5ErkJggg==)

where X is the FFT of x.

Thus, the power spectrum can be found by first computing FFT of x, and then multiplying the result with by its complex conjugate.

Task

Compute and plot the power spectrum of both the ECG signals. The data is in the vectors called 'ecg1' and 'ecg2'.

Useful commands

conj, fft

## [Moving average filtering](https://grader.mathworks.com/courses/91023-521273s-biosignal-processing-i-online-labs-autumn-2022/assignments/244168-assignment-2-ecg-filtering-to-remove-noise/problems/869063-moving-average-filtering)
Background

The general form of moving average (MA) filter is:

![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASQAAAA0CAYAAAAjWEXDAAAODklEQVR4Xu2d6et/2xTH7/0DuKZHeHAzFCEyPjAUZS4pc6RbZLjkgRsukuQawy2FS9Q3kfmJMheFlDFCHhiS8MjsD2C99HnXstvD2ufsc77n8/vtT62+v9/nnLOH9177vddae+3zufaa+ZkITAQmAgdB4NqDtGM2YyIwEZgIXDMJaSrBRGAicBgEJiEdZihmQyYCE4FJSFMHJgITgcMgMAnpMEMxGzIRmAhMQpo6AALPNbnJ5KEmvzW5VwLLo+z/rzR5jsnXTN5v8uUJ3URgNAKTkEYjer7lQTrfOTX/0fb3uxlS4vqDTH52vt2cLT8yApOQjjw6+7bttVbdu05VYgU9Kan+bfb/J5g8bN9mzdquJgQmIV1No13v6w/t8tdN3nC67Z7293fuEa5/zuTdE7KJwFYITELaCtnzKvfO1ty/nNyx19tfYkWvc+Sj6zlX7rx6Olt7aAQmIR16eHZrHEHtW0wIZvtYkvRD1x9h1/+6W6tmRVcdApOQrrohz3b4g6dvbzz9/Y39xWV7nsmnTdLrE7WJwCYITELaBNZwobhC9w3fvfzGP9ujPh6UlvQ3++IFJtrKxyL6lImC2xDUq9z15S2ZT04EKgjsTUhPsbb8yWTEtvE9rJz7nPkk8e7Rlor6IStc1k9azwPti2+ZkIMk0oIof21yR5OXmbwjub5lW8+5bLC825nr5Ej8X2qFfbinwD0JiVX3MZWJ0dNu3ctW9fWDy1zSjjXPfNUefuKpgKeuUGbI7fYmjzRhex6C8Z+72H9y8R8wfJZJup3PNj87bn83+YFJmgawps9X4rOQEWkTzy/gfCX2udUnDBAs6zAmexESZPR0E/6O/px7fMNbI0x+b6mswYoJwgr18lMhigelZZa287FAydrmg5XUtdKtaXjmWVke97drR0w7oH0fNYG0r/Sgv8aChe8PAb3QKYAQNnsQEiv3F03uveFgYWVcmBCAPcePd91ySYlr+iT8IZfUChLplMgKPEkBuKzsbBYbrD0C7HxGY7MGVz2rBeVp9kWa3T6i/KOUIWvn4dYgXHk+UYs+7MlsTUgaLOIXW5JFLg5ylIGMtkMuEvf7HKDo87X7cvigYG8xwSL7kcmLTdLYHmR2q8llZmd7sh6NywhsWQyJvZVidCPqOFIZLBKyukthgLS98MD3TZobI1sTEsz4EpP0sOYWAAMUK/45xzpwnxT7GZ2EiPt2nckRXZ6aPkCcXzrdMBqTtXooskyz2teWe+TnFfPstVZx3ZijVU9pS0LayzrS4Ek5Lsu9GKFEsmQwiXGxRiciYoW9cURDdyxDKzLxtTvtWG+kqqvNOgKT/5yA6bVWxQecBCjGI7ckJFbk20yiZl1EAVr3kC/DeaxzNp+VA0RfP2OyxUZAC8cjXVeS5tGwYPH4qUk0jnIkTJe2pfVGiFa5igkWPaYtCQn3g8+e8Qc6zAQ+2kraGqj0uoLJfH/ZO1y9bR95vyb9EXFQzG/PBXcktkvK8m+EWMIdWmyLXkykUGUT/8p6kG5pErO5q0l6TYcx327XelwEnru7iQ+uqo5WtjEAyyo7Z7eNfigIqN2lc+/PEuX348m/fZwGorqdyb8TXVlaD8+pzHSnTPqf6t/SBRcrw9eh8kf2ZQ0OtWcV4+yNH6lMLTDFRbZESID2ZBOi6driyxXCkQOu00Cf/CTTruVnErAkt+RxJtpOVD0QERaPkgaJITy2oYCqt7SNXQNbxLd2MHPEvaRMbx2wCxbK41hS0YGfkaWot1iiL7ytUkRN09E9XPTa0ZhSFynvhSakFuS2shWIzek4sZTWxGQM0d8Hm7BZQbvlekJErzbR615o4xK93Wv4ZGRQn5+jz7T/33zCDz19swk7aqV8LHArnhxoWUh+pc4FWUtbgLJUWrsiIoELp2QMGqsfxxneeUJbLw5rWVxRIswNojdH1wzySGvGt6l2/GNNe4/8rAKojPvPTdA3yOePJnqlLu1fGl+CMLDGfRKoyoKsPnGaPCzMxCYVz9Ni0VpwZf34tkI63zAhIM6c+riJdhGZ0HuGOHrG3u92eh1XsJq5GtnBrRJ5i5BosA+y5ggGJQFED6QmUouQBIg3BVE4BkbWkA+kRVaQKgNXRoB+3tAzQoV7l67WpapHHS0Z0LVdi/ATAEIiQTPddVTAG+t5beKtcFZOVnq+z3e+d+HzOWbMOfSdzG7tNol4j7zo+KNEitFCRuCWy2Gr6TNB7WxgO0JI3lTLWSg09J8JO/YQUmoK0rn3miiRUtYWHYwEECOm9K4za2VlWx0tWdmszR/3k7hEOJ6sI7pRa7S3RuV6lH7IoJeQtOBifWEV4QJqJ9i75j07drRh7acnszzd7cSqhA9wOXvcZY1ZlnsihESn5cvnYhk09BkmPhDdQ0h+JcQnT7Ne5Ra2/HUNzpVGSPTLY7TUPVmrvHs/rwlAvbVzeMRmRuQoeUu8hXEPIfkFFx1OrQPvgUTnI5jIqlo6Lj2Ypecaf2mVXpgsyZMbQkjeSvH+Y+nQbA8h+ThU7id4FDhv+esMzNLdvaWDuudzwinitu7Zri3q8hOgFFfxE90TiOKS97OGYX28ySR64NXHrGq7wz2E5AkHrNKsbi320QVXeDOx13z+YQ9Hc9x8H5iHxHSXJu5WdyejjOzNSj8hctYRIKkDkRiSXwlTk9XXGwkW9yhKOphH22Xz7dPmwrknfUYnkF8ASwRcim3qPVkEinsmjd/AaZGDCDOySPoFNxfy0IJ75HwznxeHZVXbeW+N8eqgtioQcAq8oTQEnnMsGyUGTzg5M1mKGTUvVW+PL67+HXGXTW1bmvPSUg7tApH79QCTr5j0xBVa5euE+DftRt65FP3VEk2A2rhrIcuRh/Sq5Xr59vtJx/etmFQ0NKB5k+tL74Lbwnur62l6Dz8IwSdN94nUD27F3fKohURFaRyJNwrW3t0T2e3yK2GORORvRncfRCpLDjsedZdN6fZL/PWWgoiQLuxGMItYoa0yU4KXlSwLBBes5Sqki19ap8a5FOyWXkWtDu5/jckNJvqxzNaihm4Wd4tODfaEk5uE6kcuVBHFeev7ct6Rt/oiXpDa2MwT7CEkb63gOgBizc+GwFDyWl6FCCe3evgYgcx2yuR1qqVX4HIdktzj7QJbKwLlKzGvlRC6ti0QADKK9OTSpNaLdKg22VtpHv56iUC1eEYWJk04WURpHAk9/ECGRCNnNb3VnWurdt+818FYXubL8FJd8kaD8Cx5NtxLwLtkZaus4rj0EJJXhAijy8evKUUt/8LHCFCWt5pAXDUSpLyIX792Au/xvAZ96yD2Evem1X9t2adWgXSoFqPx2/0pcfE8L/vjUyNpESwLk7KleeZ7JmTSv8iEtx2SYEl5/uVqPh+J3CfcPrKP0xSA1svtqE9l5eaLD9zTT14/fJPJ0RIjPR6+bWl+HO/K/4JJzRhQIL74iqAeQgJgEUjLnOXeVgan38rOleeZGTOfQa2Z+hECbE2ko1wXdqycPWcBl7RfOI8kPilrblylQ6UYjScktYnJC4mQ8wImtZ0zEaysDrD8pAlHTiCVNFaYunVe78Cz5vbVJlgrfy89GkSgeJSFukQPSs+Udh4ZE+Yl7cZQ4FNbJCIEfs0SQorGc2ggg196QZuP2eQYU6byHayMC5PWGydRjh/vMIFHDnapLEx5tqpHv2wu9z4k797QnsebXGfyC5PamaQaDrWFS9dqsQcm67NNHnKqhC1qMqc5ctFKwhPhQGb8OAFE9lkTufmUzTt50CuRlO8Leoc1zgTKXff3yuLLeQHUoyNPWO25MAPjQR8J+n/sNOY1XPe+1uqDsKRdtVAK1xmX3I9J/F+feggJ8C9MeuMze/wmvM4drT0+sPeA5+rTUZzRh2nBiBezpxaXd29oDwTF5E+PNUSxwfLRLkzNQopY2dE6/X0sTBzUJhOaH5Z4xcYTXaQyevFY0vejPiNrqvne8SghqcAlv4gBi+Jbptnco8CTe9Ps7KgKNywHd4GVZnQQWxil5WqFlxuENYFl5OMlvUcUiNFcJiGlGcxRHV86rDrP5Y87LS3rSn2ORQIrsHn4NjJYAjwX2IsCiFLfajJ61ad+Onth0nLpom29rPvW5FDV2sxiQmAWXz+1buXeECeBrFpmdxQbbdvvbSEpLgnB8uGU/sjYWKn/SmnYatGN4n7E+9Cx601Cb3HNEZJiOzDa50/K7E8mL+20/NHwj8YFKsK9+fYVQEayQKOvcAhA879NBSyem09klMuD8TsllNmTU1Jrw5qgdqRvpXsUEIcI/2VCTpF2uMCDT/QYSW87FDwvxYt6y7sS7odLun4cNkdIqZKOXGGYeLzraNRPaY8q6zIHXxZoaxcx0kasLLKuUQKUQSn+PJsGXrULxE4JC85tJrkNi95DnMSQIEICumkKhqzArd77Q7ySfiq0IF1Gh8GEuNgI3SuNhRJNR2a7R8b9qPdgsZbemJBtc46QFDnH7H6PSWtX46hgnEu7fNbrVm3OEYDcGyyn95mQeQ+BibhYPBj7JTEkdukg2FJiZDSDugcPT7DKl1H8knKavwnWU9m8dxsEIjGkbWqepYKA31bdEpELKzyNsXn3xufnYCX93iQNbve2L33jg+IsnEEb6bb3tmvef2AEJiEdeHA2blrq3igGwpb5qFgWbuMtJh8x4b3SPzE5Yr7NxlDP4qMITEKKIjXvmwhMBDZHYBLS5hDPCiYCE4EoApOQokjN+yYCE4HNEZiEtDnEs4KJwEQgisAkpChS876JwERgcwQmIW0O8axgIjARiCIwCSmK1LxvIjAR2ByB/wJNQHxiTred1wAAAABJRU5ErkJggg==) (1)

Applying the z-transform, we get the transfer function H(z) of the filter as:

![](data:image/png;base64,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) (2)

Given the filter coefficient vectors a and b, you can use the 'filter' function to apply the said filter to data in MATLAB.

Task

Your task is to construct the 10-point moving average filter, i.e. to specify the vectors a and b that are used with the 'filter' command according to the eq. 1 and 2.

The data is in the vectors called 'ecg1' and 'ecg2'.

NOTE: If you are testing your solution online before submitting it, you must first load the data into the dependent variables first as in previous problem(s). This is not required for submissions, as the system loads the data for you.

## [Derivative based filtering](https://grader.mathworks.com/courses/91023-521273s-biosignal-processing-i-online-labs-autumn-2022/assignments/244168-assignment-2-ecg-filtering-to-remove-noise/problems/869068-derivative-based-filtering)
Background

A derivative based filter has the following transfer function:

![](data:image/png;base64,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) (3).

Task

Construct the derivative based filter to remove low-frequency artifact according to equation 3, and normalize the filter to have a maximal gain of unity: divide the gain b by real(max(freq_response)). In other words, specify and normalize the filter coefficients a and b, and use them with the filter command.

The data is in the vectors called 'ecg1' and 'ecg2'.

Useful commands

freqz

## [Comb filtering](https://grader.mathworks.com/courses/91023-521273s-biosignal-processing-i-online-labs-autumn-2022/assignments/244168-assignment-2-ecg-filtering-to-remove-noise/problems/869073-comb-filtering)
Background

As noted in the moving average filtering problem, the general form of a MA filter is

![](data:image/png;base64,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) (1)

In this problem, we are using a comb filter that has the coefficients b = [0.6310 -0.2149 0.1512 -0.1288 0.1227 -0.1288 0.1512 -0.2149 0.6310] and a = 1.

Task

Construct the comb filter to remove 60 Hz power line interference, and use it to filter the data.

The data is in the vectors called 'ecg1' and 'ecg2'.

## [Cascaded filtering](https://grader.mathworks.com/courses/91023-521273s-biosignal-processing-i-online-labs-autumn-2022/assignments/244168-assignment-2-ecg-filtering-to-remove-noise/problems/869078-cascaded-filtering)
Background

Cascading time invariante digital filters in a series creates a new joint filter. The transfer function of the resulting filter is equal to the multiplication of the transfer functions of the individual filters, and the order of the filters in the series (and multiplication) does not matter. And since multiplication in the frequency domain is equal to convolution in the time domain, the response of the joint filter can be obtained as the convolution of the individual filter coefficients.

Task

Construct the filter coefficient of the joint filter that combines all the filters in the previous problems, i.e. the moving average filter, derivative based filter, and the comb filter. Then, use the filter on both the ECG data as previously.

The ecg data is in the vectors called 'ecg1' and 'ecg2'.

Useful commands

conv

Note

Please remind that you have to copy the coefficients from the previous solutions here as they are not passed on to different tasks.

